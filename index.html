<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Legal Aid Assistant - India</title>

<style>
    body {
        font-family: 'Poppins', sans-serif;
        background: url('/background.jpg');
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        margin: 0;
        padding: 0;
        backdrop-filter: blur(1px);
    }
    header {
        background: rgba(0, 100, 0, 0.9);
        color: #ffeb3b;
        padding: 18px;
        text-align: center;
        font-size: 28px;
        font-weight: 700;
        letter-spacing: 1px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.4);
        border-bottom: 4px solid #cddc39;
    }
    .container {
        width: 90%;
        max-width: 700px;
        margin: 25px auto;
        background: rgba(255, 255, 255, 0.9);
        padding: 30px;
        border-radius: 18px;
        border: 3px solid #4caf50;
        box-shadow: 0px 6px 20px rgba(0,0,0,0.25);
        animation: fadeIn 0.6s ease-in-out;
    }
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px);} 
        to { opacity:1; transform: translateY(0);} 
    }
    label {
        font-weight: bold;
        margin-top: 12px;
        color: #1b5e20;
        font-size: 18px;
    }
    select,
    textarea,
    button,
    input[type=file] {
        width: 100%;
        padding: 14px;
        border: 2px solid #8bc34a;
        border-radius: 12px;
        margin-bottom: 18px;
        font-size: 17px;
        outline: none;
        background: #f1f8e9;
    }
    textarea:focus,
    select:focus,
    input[type=file]:focus {
        border-color: #33691e;
        background: white;
    }
    button {
        background: #2e7d32;
        color: #f9fbe7;
        font-weight: 700;
        cursor: pointer;
        border: none;
        transition: 0.3s;
    }
    button:hover {
        background: #1b5e20;
        transform: translateY(-2px);
    }

    .mic-btn {
        width: 65px;
        height: 65px;
        border-radius: 50%;
        background: #d32f2f;
        color: white;
        font-size: 30px;
        border: 4px solid #ffcdd2;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 10px auto;
        transition: 0.2s;
    }
    .mic-btn.active { background: #00c853; }
    .mic-btn:hover { transform: scale(1.1); }

    #responseBox {
        margin-top: 22px;
        background: #e8f5e9;
        border-left: 6px solid #4caf50;
        padding: 18px;
        border-radius: 12px;
        min-height: 80px;
        display: none;
        font-size: 17px;
        color: #1b5e20;
        font-weight: 500;
    }
</style>
</head>
<body>

<header> AI Legal Aid Assistant</header>

<div class="container">

    <label>Select Language</label>
    <select id="language">
        <option value="en">English</option>
        <option value="hi">Hindi</option>
        <option value="kn">Kannada</option>
        <option value="te">Telugu</option>
    </select>

    <label>Describe your legal issue</label>
    <textarea id="userQuery" rows="5" placeholder="Example: ‡§Æ‡•á‡§∞‡§æ ‡§ú‡§Æ‡•Ä‡§® ‡§ï‡§æ ‡§ù‡§ó‡§°‡§º‡§æ ‡§π‡•à..."></textarea>

    <button class="mic-btn" id="micBtn">üé§</button>

    <label>Upload Document / Image</label>
    <input type="file" id="uploadImage" accept="image/*" multiple>

    <label>Enable Voice Assistant</label>
    <select id="voiceOption">
        <option value="off">Off</option>
        <option value="on">On</option>
    </select>

    <button onclick="sendQuery()">Ask Lawyer AI</button>

    <div id="responseBox"></div>
</div>

<script>
// üéô Speech Recognition
const micBtn = document.getElementById("micBtn");
const queryBox = document.getElementById("userQuery");
let recognition;
if ("webkitSpeechRecognition" in window) {
    recognition = new webkitSpeechRecognition();
    recognition.continuous = false;
    recognition.interimResults = false;
    recognition.lang = "hi-IN";
    recognition.onstart = () => micBtn.classList.add("active");
    recognition.onend = () => micBtn.classList.remove("active");
    recognition.onresult = (event) => {
        queryBox.value = event.results[0][0].transcript;
    };
} else { alert("Browser does not support voice input"); }
micBtn.addEventListener("click", () => {
    const lang = document.getElementById("language").value;
    recognition.lang = (lang === "en") ? "en-IN" : lang + "-IN";
    recognition.start();
});

// üì© API Request with Voice Output
async function sendQuery() {
    const query = queryBox.value.trim();
    const lang = document.getElementById("language").value;
    const voice = document.getElementById("voiceOption").value;

    if (!query){ alert("Please enter your issue."); return; }

    const responseBox = document.getElementById("responseBox");
    responseBox.style.display = "block";
    responseBox.innerHTML = "‚è≥ Processing...";

    // Get uploaded files
    const files = document.getElementById('uploadImage').files;

    try {
        const response = await fetch("http://localhost:5000/api/legal", {
            method: "POST",
            body: JSON.stringify({ question: query, language: lang, files: Array.from(files).map(f => f.name) }) ,
            headers: { "Content-Type": "application/json" }
        });

        const data = await response.json();
        responseBox.innerHTML = data.answer || "No response. Try again.";

        // Voice output
        if(voice === 'on' && 'speechSynthesis' in window){
            const utterance = new SpeechSynthesisUtterance(data.answer);
            utterance.lang = (lang==='hi')?'hi-IN':(lang==='kn')?'kn-IN':(lang==='te')?'te-IN':'en-IN';
            window.speechSynthesis.speak(utterance);
        }

    } catch (error) {
        responseBox.innerHTML = "‚ö†Ô∏è Backend not connected!";
    }
}
</script>

</body>
</html>
